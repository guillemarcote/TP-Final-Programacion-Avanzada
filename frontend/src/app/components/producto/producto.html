<button (click)="logout()">Cerrar sesión</button>

<p *ngIf="auth.isAdmin()">¡Bienvenido administrador!</p>
<p *ngIf="auth.isComprador()">¡Hola comprador!</p>


<!-- Lista de productos -->
<h2>Lista de productos</h2>
<ul>
  <li *ngFor="let producto of productos">
    {{ producto.nombre }} - ${{ producto.precio }}

    <!-- Acciones solo para admin -->
    <button *ngIf="auth.isAdmin()" (click)="editarProducto(producto)">Editar</button>
    <button *ngIf="auth.isAdmin()" (click)="eliminarProducto(producto.id)">Eliminar</button>

    <!-- Acción solo para comprador -->
    <button *ngIf="auth.isComprador()" (click)="agregarAlCarrito(producto)">Agregar al carrito</button>
  </li>
</ul>

<div *ngIf="!cargando && productosPagina.length === 0">
  No hay productos para mostrar.
</div>

<!-- Paginación -->
<div class="pagination" *ngIf="totalPaginas > 1">
  <button (click)="cambiarPagina(paginaActual - 1)" [disabled]="paginaActual === 1">
    Anterior
  </button>

  <span>Página {{ paginaActual }} de {{ totalPaginas }}</span>

  <button (click)="cambiarPagina(paginaActual + 1)" [disabled]="paginaActual === totalPaginas">
    Siguiente
  </button>
</div>

<hr />

<!-- Formulario para agregar/editar (igual que antes) -->
<!-- Solo los admins pueden agregar productos -->
<div *ngIf="auth.isAdmin()">
  <h2>Cargar nuevo producto</h2>
  <!-- formulario aquí -->
   <form (ngSubmit)="guardarProducto()" class="mt-4">
  <label class="form-label">
    Nombre:
    <input type="text" [(ngModel)]="productoModel.nombre" name="nombre" required class="form-control" />
  </label>
  <br />

  <label class="form-label">
    Descripción:
    <textarea [(ngModel)]="productoModel.descripcion" name="descripcion" required class="form-control"></textarea>
  </label>
  <br />

  <label class="form-label">
    Precio:
    <input type="number" [(ngModel)]="productoModel.precio" name="precio" min="0" step="0.01" required class="form-control"/>
  </label>
  <br />

  <label class="form-label">
    Stock:
    <input type="number" [(ngModel)]="productoModel.stock" name="stock" min="0" required class="form-control"/>
  </label>
  <br />

  <button type="submit" class="btn btn-primary">{{ editando ? 'Actualizar' : 'Agregar' }}</button>
  <button type="button" (click)="limpiarFormulario()" class="btn btn-secondary ms-2">Cancelar</button>
</form>
</div>


<div *ngIf="carrito.length > 0">
  <h3>🛒 Carrito</h3>
  <ul>
    <li *ngFor="let item of carrito">
      {{ item.nombre }} - ${{ item.precio }}
    </li>
  </ul>

  <p><strong>Total: ${{ getTotalCarrito() }}</strong></p>

  <button (click)="vaciarCarrito()">Vaciar carrito</button>
  <button (click)="comprar()">Comprar</button>
</div>
